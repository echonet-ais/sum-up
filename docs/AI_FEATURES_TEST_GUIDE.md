# AI 기능 테스트 가이드

> **작성일**: 2025-11-29  
> **목적**: AI 기능들의 실제 작동 여부를 확인하기 위한 테스트 가이드

---

## 🔧 사전 준비

### 환경 변수 확인

`.env.local` 파일에 다음 환경 변수가 설정되어 있는지 확인:

```env
# AI Provider 설정 (gpt 또는 gemini)
AI_PROVIDER=gpt

# OpenAI API Key (AI_PROVIDER=gpt일 때)
OPENAI_API_KEY=sk-...

# Gemini API Key (AI_PROVIDER=gemini일 때)
GEMINI_API_KEY=...
```

### 테스트 전 확인 사항

- [ ] 서버가 실행 중인가? (`npm run dev`)
- [ ] 로그인되어 있는가?
- [ ] 최소 1개의 프로젝트가 있는가?
- [ ] 최소 1개의 이슈가 있는가? (설명이 10자 이상)

---

## 📋 테스트 체크리스트

### 1. AI 설명 요약 생성 (FR-040)

**테스트 위치**: 이슈 상세 페이지 (`/issues/[id]`)

**테스트 절차**:
1. 이슈 목록에서 설명이 10자 이상인 이슈를 선택
2. 이슈 상세 페이지로 이동
3. "AI 기능" 섹션에서 "요약 생성" 버튼 클릭
4. 로딩 상태 확인 (버튼에 "생성 중..." 표시)
5. 결과 확인:
   - [ ] 요약 내용이 표시되는가?
   - [ ] 마크다운 형식으로 렌더링되는가?
   - [ ] 에러가 발생하지 않는가?

**예상 결과**:
- 이슈 설명을 기반으로 한 간결한 요약이 생성됨
- 요약은 마크다운 형식으로 표시됨

**에러 케이스 테스트**:
- [ ] 설명이 10자 이하인 이슈에서 "요약 생성" 버튼 클릭 → 경고 메시지 표시 확인
- [ ] 로그인하지 않은 상태에서 버튼 클릭 → 경고 메시지 표시 확인

---

### 2. AI 해결 전략 제안 (FR-041)

**테스트 위치**: 이슈 상세 페이지 (`/issues/[id]`)

**테스트 절차**:
1. 이슈 상세 페이지에서 "제안 생성" 버튼 클릭
2. 로딩 상태 확인
3. 결과 확인:
   - [ ] 해결 전략 제안이 표시되는가?
   - [ ] 마크다운 형식으로 렌더링되는가?
   - [ ] 실용적인 제안이 포함되어 있는가?

**예상 결과**:
- 이슈 제목과 설명을 기반으로 한 해결 전략이 생성됨
- 단계별 제안이나 구체적인 해결 방법이 포함됨

---

### 3. AI 댓글 요약 (FR-045)

**테스트 위치**: 이슈 상세 페이지 (`/issues/[id]`)

**사전 조건**:
- 댓글이 5개 이상인 이슈 필요

**테스트 절차**:
1. 댓글이 5개 이상인 이슈 상세 페이지로 이동
2. "댓글 요약" 버튼 클릭
3. 로딩 상태 확인
4. 결과 확인:
   - [ ] 댓글 요약이 표시되는가?
   - [ ] 주요 논의 사항이 요약되어 있는가?
   - [ ] 마크다운 형식으로 렌더링되는가?

**예상 결과**:
- 모든 댓글을 종합한 요약이 생성됨
- 주요 논의 사항과 결론이 포함됨

**에러 케이스 테스트**:
- [ ] 댓글이 5개 미만인 이슈에서 버튼 클릭 → 경고 메시지 표시 확인

---

### 4. AI 이슈 자동 분류 (FR-043)

**테스트 위치**: 이슈 생성/수정 폼 (`IssueForm`)

**사전 조건**:
- 프로젝트에 최소 1개 이상의 라벨이 있어야 함

**테스트 절차**:
1. 새 이슈 생성 또는 기존 이슈 수정
2. 프로젝트 선택
3. 제목과 설명 입력 (예: "로그인 버튼이 작동하지 않음")
4. "AI 자동 분류" 버튼 클릭 (IssueFormFields에서)
5. 결과 확인:
   - [ ] 추천 라벨이 자동으로 선택되는가?
   - [ ] 성공 토스트 메시지가 표시되는가?
   - [ ] 추천된 라벨이 적절한가?

**예상 결과**:
- 이슈 제목과 설명을 분석하여 적절한 라벨이 추천됨
- 추천된 라벨이 자동으로 선택됨

**에러 케이스 테스트**:
- [ ] 프로젝트를 선택하지 않은 상태에서 버튼 클릭 → 에러 처리 확인
- [ ] 라벨이 없는 프로젝트에서 버튼 클릭 → 에러 처리 확인

---

### 5. AI 중복 이슈 탐지 (FR-044)

**테스트 위치**: 이슈 생성 폼 (`IssueForm`)

**사전 조건**:
- 최소 1개 이상의 기존 이슈가 있어야 함

**테스트 절차**:
1. 새 이슈 생성 폼 열기
2. 제목과 설명 입력 (기존 이슈와 유사한 내용)
3. 제목 입력 후 자동으로 중복 탐지 실행됨 (또는 수동 트리거)
4. 결과 확인:
   - [ ] 중복 이슈가 감지되면 경고 메시지가 표시되는가?
   - [ ] 중복 이슈 목록이 표시되는가?
   - [ ] 중복 이슈 링크가 작동하는가?

**예상 결과**:
- 유사한 제목/설명을 가진 기존 이슈가 자동으로 탐지됨
- 중복 이슈 목록이 표시되고 클릭 가능한 링크 제공

**에러 케이스 테스트**:
- [ ] 제목이 5자 미만인 경우 → 중복 탐지가 실행되지 않음 확인
- [ ] 기존 이슈가 없는 경우 → 정상 작동 확인 (에러 없음)

---

## 🔍 API 직접 테스트

### cURL 명령어로 테스트

#### 1. 설명 요약 생성

```bash
curl -X POST http://localhost:3000/api/ai/summary \
  -H "Content-Type: application/json" \
  -d '{
    "issueId": "your-issue-id",
    "description": "이슈 설명이 10자 이상이어야 합니다. 예를 들어, 로그인 버튼을 클릭했을 때 아무 반응이 없습니다.",
    "userId": "your-user-id"
  }'
```

#### 2. 해결 전략 제안

```bash
curl -X POST http://localhost:3000/api/ai/suggestion \
  -H "Content-Type: application/json" \
  -d '{
    "issueId": "your-issue-id",
    "title": "로그인 버튼이 작동하지 않음",
    "description": "로그인 버튼을 클릭했을 때 아무 반응이 없습니다.",
    "userId": "your-user-id"
  }'
```

#### 3. 자동 분류

```bash
curl -X POST http://localhost:3000/api/ai/auto-label \
  -H "Content-Type: application/json" \
  -d '{
    "title": "로그인 버튼이 작동하지 않음",
    "description": "로그인 버튼을 클릭했을 때 아무 반응이 없습니다.",
    "availableLabels": [
      {"name": "버그", "color": "#ef4444"},
      {"name": "UI", "color": "#3b82f6"}
    ],
    "userId": "your-user-id"
  }'
```

#### 4. 중복 탐지

```bash
curl -X POST http://localhost:3000/api/ai/duplicate-detection \
  -H "Content-Type: application/json" \
  -d '{
    "title": "로그인 버튼이 작동하지 않음",
    "description": "로그인 버튼을 클릭했을 때 아무 반응이 없습니다.",
    "existingIssues": [
      {
        "id": "issue-1",
        "title": "로그인 문제",
        "description": "로그인 버튼 클릭 시 반응 없음"
      }
    ],
    "userId": "your-user-id"
  }'
```

#### 5. 댓글 요약

```bash
curl -X POST http://localhost:3000/api/ai/comment-summary \
  -H "Content-Type: application/json" \
  -d '{
    "issueId": "your-issue-id",
    "issueTitle": "이슈 제목",
    "issueDescription": "이슈 설명",
    "comments": [
      {
        "author": {"name": "사용자1"},
        "content": "첫 번째 댓글 내용",
        "createdAt": "2025-11-29T10:00:00Z"
      },
      {
        "author": {"name": "사용자2"},
        "content": "두 번째 댓글 내용",
        "createdAt": "2025-11-29T11:00:00Z"
      }
    ],
    "userId": "your-user-id"
  }'
```

---

## 🐛 문제 해결

### 일반적인 문제

#### 1. "AI API key not configured" 에러

**원인**: 환경 변수가 설정되지 않음

**해결 방법**:
1. `.env.local` 파일 확인
2. `AI_PROVIDER` 값 확인 (gpt 또는 gemini)
3. 해당 provider의 API 키가 설정되어 있는지 확인
4. 서버 재시작

#### 2. "Rate limit exceeded" 에러

**원인**: 사용자당 시간당 10회 제한 초과

**해결 방법**:
- 잠시 기다린 후 다시 시도
- 또는 다른 사용자로 테스트

#### 3. "Description must be longer than 10 characters" 에러

**원인**: 이슈 설명이 너무 짧음

**해결 방법**:
- 이슈 설명을 10자 이상으로 수정

#### 4. API 호출은 성공하지만 결과가 비어있음

**원인**: AI 모델이 응답을 생성하지 못함

**해결 방법**:
- API 키가 유효한지 확인
- API 할당량 확인
- 다른 provider로 변경해보기

---

## 📊 테스트 결과 기록

### 테스트 결과 표

| 기능 | 테스트 일시 | 결과 | 비고 |
|------|------------|------|------|
| 설명 요약 생성 | | ✅/❌ | |
| 해결 전략 제안 | | ✅/❌ | |
| 댓글 요약 | | ✅/❌ | |
| 자동 분류 | | ✅/❌ | |
| 중복 탐지 | | ✅/❌ | |

### 발견된 문제

```
[테스트 중 발견한 문제를 여기에 기록]
```

---

## ✅ 완료 기준

모든 AI 기능이 다음 조건을 만족해야 합니다:

- [ ] API 호출이 성공적으로 완료됨
- [ ] 결과가 적절하게 표시됨
- [ ] 에러 처리가 적절함
- [ ] 로딩 상태가 표시됨
- [ ] Rate limiting이 작동함
- [ ] 캐싱이 작동함 (같은 요청 시 즉시 응답)

---

**참고 문서**:
- [FEATURE_STATUS.md](./FEATURE_STATUS.md) - 기능 상태
- [BACKEND_API_GUIDE.md](./BACKEND_API_GUIDE.md) - API 가이드

